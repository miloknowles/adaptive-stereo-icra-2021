Note that this code was used during early experimentation and is probably not in working form.